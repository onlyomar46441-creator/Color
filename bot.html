<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@MagmaStoreBot - Ø¨ÙˆØª Ø§Ù„Ø±Ø¨Ø·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .bot-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px solid #0088cc;
        }

        .bot-info h2 {
            color: #0088cc;
            margin-bottom: 15px;
        }

        .code-input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
            direction: ltr;
            letter-spacing: 2px;
        }

        .btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-bottom: 20px;
        }

        .result {
            padding: 20px;
            background: #e6f7ff;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .result.success {
            background: #d4edda;
            border: 2px solid #155724;
            color: #155724;
        }

        .result.error {
            background: #f8d7da;
            border: 2px solid #721c24;
            color: #721c24;
        }

        .instructions {
            text-align: right;
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 10px;
            border-right: 4px solid #856404;
        }

        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .instructions ol {
            padding-right: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1><i class="fab fa-telegram"></i> @MagmaStoreBot</h1>
        
        <div class="bot-info">
            <h2><i class="fas fa-robot"></i> Ø¨ÙˆØª Ø±Ø¨Ø· Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©</h2>
            <p>Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ø°ÙŠ Ø­ØµÙ„Øª Ø¹Ù„ÙŠÙ‡ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
        </div>
        
        <input type="text" id="codeInput" class="code-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ù‡Ù†Ø§ (Ù…Ø«Ø§Ù„: AbC123DeF)" maxlength="20">
        
        <button id="linkBtn" class="btn">
            <i class="fas fa-link"></i> Ø±Ø¨Ø· Ø§Ù„Ø±Ù…Ø² Ø¨Ø­Ø³Ø§Ø¨Ùƒ
        </button>
        
        <div id="resultMessage" class="result"></div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø±Ø¨Ø·:</h3>
            <ol>
                <li>Ø£Ù†Ø´Ø¦ Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©</li>
                <li>Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± Ù„Ùƒ</li>
                <li>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø£Ø¹Ù„Ø§Ù‡</li>
                <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø±Ø¨Ø· Ø§Ù„Ø±Ù…Ø² Ø¨Ø­Ø³Ø§Ø¨Ùƒ"</li>
                <li>Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø±Ù…Ø²Ùƒ Ù…Ø¹ ID Ø­Ø³Ø§Ø¨Ùƒ Ø¹Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…</li>
                <li>Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø³ØªØµÙ„ Ø¥Ù„ÙŠÙƒ Ø¹Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…</li>
            </ol>
        </div>
    </div>

    <script>
        // ============ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… ============
        const TELEGRAM_BOT_TOKEN = "8319256664:AAHw0suclrThu0X3dcdeoDT1LPwWRb59xR4";
        const ADMIN_CHAT_ID = "6612813200";
        const MAIN_SITE_URL = "https://onlyomar46441-creator.github.io/Color/index.html";
        
        // ============ ØªÙˆÙ„ÙŠØ¯ chat_id ÙˆÙ‡Ù…ÙŠ (ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ Ù‡Ø°Ø§ Ø³ÙŠÙƒÙˆÙ† chat_id Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…) ============
        // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ø°Ø§ Ø³ÙŠÙƒÙˆÙ† chat_id Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        // Ù„ÙƒÙ†Ù†Ø§ Ø¹Ù„Ù‰ GitHub PagesØŒ Ø³Ù†Ø³ØªØ®Ø¯Ù… ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø©
        
        function generateChatId() {
            // ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ØŒ Ù‡Ø°Ø§ Ø³ÙŠÙƒÙˆÙ† chat_id Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† ØªÙ„ÙŠØ¬Ø±Ø§Ù…
            // Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø©
            let chatId = localStorage.getItem('telegram_chat_id');
            
            if (!chatId) {
                // Ø¥Ù†Ø´Ø§Ø¡ chat_id ÙˆÙ‡Ù…ÙŠ
                chatId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('telegram_chat_id', chatId);
            }
            
            return chatId;
        }
        
        // ============ Ø±Ø¨Ø· Ø§Ù„Ø±Ù…Ø² ============
        document.getElementById('linkBtn').addEventListener('click', async function() {
            const codeInput = document.getElementById('codeInput');
            const code = codeInput.value.trim();
            const resultDiv = document.getElementById('resultMessage');
            
            if (!code || code.length < 8) {
                showResult('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² ØµØ­ÙŠØ­ (8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)');
                return;
            }
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ chat_id (ÙˆÙ‡Ù…ÙŠ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„)
            const chatId = generateChatId();
            
            try {
                // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ø¨Ø· Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ø¨Ø± localStorage
                const linkData = {
                    code: code,
                    chatId: chatId,
                    timestamp: new Date().toISOString()
                };
                
                // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                localStorage.setItem('link_request', JSON.stringify(linkData));
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…
                await sendTelegramNotification(
                    `ğŸ”— Ø·Ù„Ø¨ Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯!\n\n` +
                    `ğŸ” Ø§Ù„Ø±Ù…Ø²: ${code}\n` +
                    `ğŸ‘¤ Chat ID: ${chatId}\n` +
                    `ğŸ•’ Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString('ar-EG')}\n` +
                    `ğŸŒ Ø§Ù„Ù…ØµØ¯Ø±: GitHub Pages Bot Interface`
                );
                
                showResult('success', 
                    `âœ… ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø±Ù…Ø² Ø¨Ù†Ø¬Ø§Ø­!\n\n` +
                    `ğŸ” Ø§Ù„Ø±Ù…Ø²: ${code}\n` +
                    `ğŸ‘¤ ØªÙ… Ø±Ø¨Ø·Ù‡ Ø¨Ø­Ø³Ø§Ø¨Ùƒ\n\n` +
                    `Ø§Ù„Ø¢Ù† Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø²ØŒ Ø³ØªØµÙ„ Ø¥Ù„ÙŠÙƒ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.`
                );
                
                // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚Ù„
                codeInput.value = '';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
                setTimeout(() => {
                    window.location.href = MAIN_SITE_URL;
                }, 3000);
                
            } catch (error) {
                console.error('Error:', error);
                showResult('error', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø¨Ø·. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
            }
        });
        
        // ============ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… ============
        async function sendTelegramNotification(text) {
            try {
                const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: ADMIN_CHAT_ID,
                        text: text,
                        parse_mode: 'HTML'
                    })
                });
                
                const data = await response.json();
                return data.ok;
            } catch (error) {
                console.error('Error sending notification:', error);
                return false;
            }
        }
        
        // ============ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© ============
        function showResult(type, message) {
            const resultDiv = document.getElementById('resultMessage');
            resultDiv.className = 'result ' + type;
            resultDiv.innerHTML = `
                <h3><i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> 
                ${type === 'success' ? 'ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!' : 'Ø®Ø·Ø£!'}</h3>
                <p>${message.replace(/\n/g, '<br>')}</p>
            `;
            resultDiv.style.display = 'block';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                resultDiv.style.display = 'none';
            }, 5000);
        }
        
        // ============ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ chat_id Ù…Ù† ØªÙ„ÙŠØ¬Ø±Ø§Ù… ============
        // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠØ£ØªÙŠ chat_id Ù…Ù† ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        // Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… localStorage Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø°Ù„Ùƒ
        
        // ØªØ­Ù…ÙŠÙ„ chat_id Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            const savedChatId = localStorage.getItem('telegram_chat_id');
            if (savedChatId) {
                console.log('Chat ID Ù…ÙˆØ¬ÙˆØ¯:', savedChatId);
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø·Ù„Ø¨ Ø±Ø¨Ø· ÙÙŠ localStorage
            const linkRequest = localStorage.getItem('link_request');
            if (linkRequest) {
                try {
                    const request = JSON.parse(linkRequest);
                    console.log('Ø·Ù„Ø¨ Ø±Ø¨Ø· Ù…ÙˆØ¬ÙˆØ¯:', request);
                    
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ø¨Ø· Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                    if (window.opener && typeof window.opener.linkUser === 'function') {
                        window.opener.linkUser(request.code, request.chatId);
                    }
                    
                    // Ù…Ø³Ø­ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                    localStorage.removeItem('link_request');
                } catch (error) {
                    console.error('Error processing link request:', error);
                }
            }
        });
        
        // ============ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ù…Ø² Ø¨Ø­Ø±ÙˆÙ ÙƒØ¨ÙŠØ±Ø© ÙÙ‚Ø· ============
        document.getElementById('codeInput').addEventListener('input', function(e) {
            this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
        });
    </script>
</body>
</html>
